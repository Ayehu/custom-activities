<?xml version="1.0" encoding="utf-8"?><SequentialWorkflowActivity x:Name="CustomWorkflow" xmlns:ns0="clr-namespace:MemorySet;Assembly=MemorySet, Version=2.0.0.0, Culture=neutral, PublicKeyToken=null" xmlns:ns1="clr-namespace:CreateMemoryTable;Assembly=CreateMemoryTable, Version=2.0.0.0, Culture=neutral, PublicKeyToken=null" xmlns:ns2="clr-namespace:GetRowsCount;Assembly=GetRowsCount, Version=2.0.0.0, Culture=neutral, PublicKeyToken=null" xmlns:ns3="clr-namespace:SendEmail;Assembly=SendEmail, Version=2.0.0.0, Culture=neutral, PublicKeyToken=null" xmlns:ns4="clr-namespace:ExitWhile;Assembly=ExitWhile, Version=2.0.0.0, Culture=neutral, PublicKeyToken=null" xmlns:ns5="clr-namespace:GetCellValue;Assembly=GetCellValue, Version=2.0.0.0, Culture=neutral, PublicKeyToken=null" xmlns:ns6="clr-namespace:ProcessCounter;Assembly=ProcessCounter, Version=2.0.0.0, Culture=neutral, PublicKeyToken=null" xmlns:ns7="clr-namespace:ReturnValue;Assembly=ReturnValue, Version=2.0.0.0, Culture=neutral, PublicKeyToken=null" xmlns:ns8="clr-namespace:Continue;Assembly=Continue, Version=2.0.0.0, Culture=neutral, PublicKeyToken=null" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow" x:Class="WorkflowDesignerControl.CustomWorkflow"><ns0:MemorySet IsValid="True" VariableScope="Workflow" RecoveryMethodSelection="{x:Null}" VariableValue="Server List:&#xD;&#xA;-----------------&#xD;&#xA;&#xD;&#xA;" DisplayName="Set Memory" IsAppend="False" VariableName="ServersTable" x:Name="CreateTable" Description="Set variable to specified memory scope." TypeName="MemorySet" IsSaved="False" /><ns1:CreateMemoryTable IsValid="True" x:Name="createMemoryTable1" ColumnNumber="1" TableName="Servers" RowNumber="4" isEmptyGrid="0" RecoveryMethodSelection="{x:Null}" Description="Creates a memory table." DisplayName="Create Memory Table" TypeName="CreateMemoryTable" TableAsString="&lt;NewDataSet&gt;&#xD;&#xA;  &lt;xs:schema id=&quot;NewDataSet&quot; xmlns=&quot;&quot; xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:msdata=&quot;urn:schemas-microsoft-com:xml-msdata&quot;&gt;&#xD;&#xA;    &lt;xs:element name=&quot;NewDataSet&quot; msdata:IsDataSet=&quot;true&quot; msdata:MainDataTable=&quot;resultSet&quot; msdata:UseCurrentLocale=&quot;true&quot;&gt;&#xD;&#xA;      &lt;xs:complexType&gt;&#xD;&#xA;        &lt;xs:choice minOccurs=&quot;0&quot; maxOccurs=&quot;unbounded&quot;&gt;&#xD;&#xA;          &lt;xs:element name=&quot;resultSet&quot;&gt;&#xD;&#xA;            &lt;xs:complexType&gt;&#xD;&#xA;              &lt;xs:sequence&gt;&#xD;&#xA;                &lt;xs:element name=&quot;Column1&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xD;&#xA;              &lt;/xs:sequence&gt;&#xD;&#xA;            &lt;/xs:complexType&gt;&#xD;&#xA;          &lt;/xs:element&gt;&#xD;&#xA;        &lt;/xs:choice&gt;&#xD;&#xA;      &lt;/xs:complexType&gt;&#xD;&#xA;    &lt;/xs:element&gt;&#xD;&#xA;  &lt;/xs:schema&gt;&#xD;&#xA;  &lt;resultSet&gt;&#xD;&#xA;    &lt;Column1&gt;Server1&lt;/Column1&gt;&#xD;&#xA;  &lt;/resultSet&gt;&#xD;&#xA;  &lt;resultSet&gt;&#xD;&#xA;    &lt;Column1&gt;Server2&lt;/Column1&gt;&#xD;&#xA;  &lt;/resultSet&gt;&#xD;&#xA;  &lt;resultSet&gt;&#xD;&#xA;    &lt;Column1&gt;Server3&lt;/Column1&gt;&#xD;&#xA;  &lt;/resultSet&gt;&#xD;&#xA;  &lt;resultSet&gt;&#xD;&#xA;    &lt;Column1&gt;192.168.1.1&lt;/Column1&gt;&#xD;&#xA;  &lt;/resultSet&gt;&#xD;&#xA;&lt;/NewDataSet&gt;" /><ns2:GetRowsCount IsValid="True" x:Name="TotalServers" RecoveryMethodSelection="{x:Null}" ResultSet="%Servers%" DisplayName="Get Rows Count" ResultSetName="Servers" Description="Gets the amount of rows in a resultset." TypeName="GetRowsCount" /><WhileActivity x:Name="whileActivity1" Condition="{x:Null}"><SequenceActivity x:Name="sequenceActivity1"><ns4:ExitWhile IsValid="True" x:Name="exitWhile1" RecoveryMethodSelection="{x:Null}" Counter="%TotalServers%" Description="Exit current while activity" DisplayName="Exit While" TypeName="ExitWhile" /><ns5:GetCellValue ColumnType="Number" IsValid="True" x:Name="ServerName" ColumnNumber="1" ResultSet="%Servers%" RowNumber="%exitWhile1%" ResultSetName="Servers" RecoveryMethodSelection="{x:Null}" Description="Gets a specific cell value from a resultset." DisplayName="Get Cell Value" TypeName="GetCellValue" /><ns6:ProcessCounter IsValid="True" x:Name="IsProcessRunning" HostName="%ServerName%" TimeInSeconds="0" Timeout="00:01:00" DisplayName="Process     Counter" Password="" RecoveryMethodSelection="{x:Null}" Description="Get the number of processes" HostId="-2" TypeName="ProcessCounter" UserName="" ProcessName="rtvscan.exe" /><IfElseActivity x:Name="CheckProcessCount"><IfElseBranchActivity x:Name="NotRunning"><ns7:ReturnValue Value="1" IsValid="True" x:Name="returnValue1" RecoveryMethodSelection="{x:Null}" ConditionName="" UseBranchWhenTimeout="False" UseStoredValue="False" ConditionType="Not Equals" DisplayName="Return Value" Formula="=Not Equals(&quot;&amp;&amp;&amp;&quot;,&quot;1&quot;)" Description="Use a returned value of a previous activity." ConditionNumber="-1" UseCustomeCondition="False" Type="UserDefinedValue" TypeName="ReturnValue" /><ns0:MemorySet IsValid="True" VariableScope="Workflow" RecoveryMethodSelection="{x:Null}" VariableValue="%ServerName%" DisplayName="Set Memory" IsAppend="True" VariableName="ServersTable" x:Name="UpdateTable" Description="Set variable to specified memory scope." TypeName="MemorySet" IsSaved="False" /></IfElseBranchActivity><IfElseBranchActivity x:Name="Running"><ns7:ReturnValue Value="1" IsValid="True" x:Name="returnValue2" RecoveryMethodSelection="{x:Null}" ConditionName="" UseBranchWhenTimeout="True" UseStoredValue="False" ConditionType="Equals" DisplayName="Return Value" Formula="=Equals(&quot;&amp;&amp;&amp;&quot;,&quot;1&quot;)" Description="Use a returned value of a previous activity." ConditionNumber="-1" UseCustomeCondition="False" Type="UserDefinedValue" TypeName="ReturnValue" /><ns8:Continue DisplayName="Continue" x:Name="continue1" RecoveryMethodSelection="{x:Null}" IsValid="True" TypeName="Continue" Description="Continue the current workfow or branch" /></IfElseBranchActivity></IfElseActivity></SequenceActivity></WhileActivity><ns3:SendEmail Channel="0" TimeInSeconds="0" Subject="Report: Anti Virus is not running on the following servers" DestinationNumber="1" x:Name="SendReport" TemplateNumber="0" ShiftLevel="" IsValid="True" HostId="-2" TemplateName="" TypeName="SendEmail" SendRN="False" RecoveryMethodSelection="{x:Null}" DestinationTypeCc="User" DestinationType="User" HostName="{x:Null}" Timeout="00:00:00" DisplayName="Send Email" Attachments="" Cc="" Description="Send an email to a user, a group or a duty." Continue="False" DestinationNumberCc="0" Body="&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.0 Transitional//EN&quot;&gt;&#xD;&#xA;&lt;HTML&gt;&lt;HEAD&gt;&#xD;&#xA;&lt;META content=&quot;text/html; charset=utf-8&quot; http-equiv=Content-Type&gt;&#xD;&#xA;&lt;META name=GENERATOR content=&quot;MSHTML 10.00.9200.16721&quot;&gt;&lt;/HEAD&gt;&#xD;&#xA;&lt;BODY style=&quot;BACKGROUND-COLOR: white&quot;&gt;&lt;FONT face=Calibri&gt;%ServersTable%&lt;/FONT&gt; &#xD;&#xA;&lt;/BODY&gt;&lt;/HTML&gt;&#xD;&#xA;" To="Admin" ShiftLevelCc="" MessageType="Custom" /></SequentialWorkflowActivity>